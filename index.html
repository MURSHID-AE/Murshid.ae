<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Murshid.com | Admin-Controlled Marketplace</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2c5530;
            --secondary: #e6b325;
            --light: #f8f9fa;
            --dark: #1a1f25;
            --white: #ffffff;
            --gray: #e9ecef;
            --text: #212529;
            --accent: #73a580;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
        }

        body {
            background-color: var(--light);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Authentication Screen */
        #authScreen {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary), var(--dark));
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .auth-container {
            background: var(--white);
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 450px;
            overflow: hidden;
        }

        .auth-header {
            background: var(--primary);
            color: var(--white);
            padding: 30px;
            text-align: center;
        }

        .auth-header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .auth-header p {
            opacity: 0.9;
        }

        .auth-tabs {
            display: flex;
            background: var(--light);
        }

        .auth-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            transition: all 0.3s;
        }

        .auth-tab.active {
            border-bottom-color: var(--secondary);
            color: var(--primary);
        }

        .auth-form {
            padding: 30px;
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--primary);
        }

        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--gray);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            border-color: var(--accent);
            outline: none;
            box-shadow: 0 0 0 3px rgba(115, 165, 128, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }

        .btn-primary {
            background: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background: #244428;
            transform: translateY(-2px);
        }

        /* Main App */
        #mainApp {
            display: none;
        }

        /* Header */
        header {
            background-color: var(--dark);
            color: var(--white);
            padding: 10px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1500px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            color: var(--white);
            text-decoration: none;
        }

        .logo i {
            color: var(--secondary);
            margin-right: 5px;
        }

        .search-bar {
            display: flex;
            flex: 1;
            max-width: 700px;
            margin: 0 20px;
        }

        .search-bar select {
            background-color: var(--gray);
            border: none;
            border-radius: 4px 0 0 4px;
            padding: 10px;
            border-right: 1px solid #ddd;
        }

        .search-bar input {
            flex: 1;
            padding: 10px;
            border: none;
            font-size: 16px;
        }

        .search-bar button {
            background-color: var(--secondary);
            border: none;
            border-radius: 0 4px 4px 0;
            padding: 10px 15px;
            cursor: pointer;
            color: var(--dark);
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            align-items: center;
        }

        .nav-item {
            margin-left: 15px;
            padding: 5px 10px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
        }

        .nav-item:hover {
            border: 1px solid var(--white);
            border-radius: 2px;
        }

        .cart {
            position: relative;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--secondary);
            color: var(--dark);
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Secondary Navigation */
        .secondary-nav {
            background-color: var(--primary);
            padding: 10px 20px;
        }

        .secondary-nav ul {
            display: flex;
            list-style: none;
            max-width: 1500px;
            margin: 0 auto;
        }

        .secondary-nav li {
            margin-right: 15px;
            color: var(--white);
            font-size: 14px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 3px;
            transition: background-color 0.3s;
        }

        .secondary-nav li:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .secondary-nav li.active {
            background-color: rgba(255,255,255,0.2);
        }

        /* Main Content */
        .container {
            max-width: 1500px;
            margin: 0 auto;
            padding: 0 20px;
            min-height: 70vh;
        }

        .section-title {
            font-size: 24px;
            margin: 30px 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
            color: var(--primary);
        }

        /* Product Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .product-card {
            background-color: var(--white);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            border: 1px solid var(--gray);
            position: relative;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        /* Admin Controls - Moved outside image area */
        .admin-controls {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 15px;
            padding: 5px;
            background-color: rgba(255,255,255,0.9);
            border-radius: 6px;
        }

        .admin-btn {
            background: var(--dark);
            color: white;
            border: none;
            border-radius: 4px;
            width: 36px;
            height: 36px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.3s;
        }

        .admin-btn:hover {
            transform: scale(1.1);
        }

        .admin-btn.edit {
            background: var(--info);
        }

        .admin-btn.delete {
            background: var(--danger);
        }

        .product-image {
            height: 200px;
            background: linear-gradient(135deg, var(--gray), #e0e0e0);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.3s;
            background-color: white;
            padding: 10px;
        }

        .product-card:hover .product-image img {
            transform: scale(1.05);
        }

        .product-image .no-image {
            color: var(--accent);
            font-size: 48px;
        }

        .product-title {
            font-weight: bold;
            margin-bottom: 10px;
            height: 44px;
            overflow: hidden;
            flex-grow: 1;
            font-size: 16px;
            line-height: 1.4;
        }

        .product-seller {
            font-size: 12px;
            color: var(--accent);
            margin-bottom: 5px;
        }

        .product-rating {
            color: var(--secondary);
            margin-bottom: 10px;
            font-size: 14px;
        }

        .product-price {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .product-stock {
            font-size: 12px;
            color: var(--success);
            margin-bottom: 15px;
        }

        .product-actions {
            display: flex;
            justify-content: space-between;
            margin-top: auto;
            gap: 10px;
        }

        .add-to-cart, .buy-now {
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            flex: 1;
        }

        .add-to-cart {
            background-color: var(--accent);
            color: var(--white);
        }

        .add-to-cart:hover {
            background-color: #5d8c69;
        }

        .buy-now {
            background-color: var(--secondary);
            color: var(--dark);
        }

        .buy-now:hover {
            background-color: #d4a320;
        }

        /* Form Styles */
        .form-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--white);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
        }

        .btn-secondary {
            background-color: var(--gray);
            color: var(--text);
        }

        .btn-secondary:hover {
            background-color: #d8d8d8;
            transform: translateY(-2px);
        }

        /* Image Upload */
        .image-upload {
            border: 2px dashed var(--gray);
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .image-upload:hover {
            border-color: var(--accent);
            background-color: rgba(115, 165, 128, 0.05);
        }

        .image-upload i {
            font-size: 48px;
            color: var(--accent);
            margin-bottom: 15px;
        }

        .image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            height: 120px;
        }

        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-item .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--gray);
            margin-bottom: 25px;
        }

        .tab {
            padding: 12px 25px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab.active {
            border-bottom-color: var(--secondary);
            color: var(--primary);
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Cart */
        .cart-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--gray);
            background: var(--white);
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .cart-item-image {
            width: 80px;
            height: 80px;
            background: var(--gray);
            border-radius: 6px;
            margin-right: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            overflow: hidden;
        }

        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-title {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .cart-item-price {
            color: var(--primary);
            font-weight: bold;
            font-size: 18px;
        }

        .cart-item-quantity {
            display: flex;
            align-items: center;
            margin-top: 8px;
        }

        .quantity-btn {
            background-color: var(--gray);
            border: none;
            width: 32px;
            height: 32px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .quantity-input {
            width: 60px;
            text-align: center;
            margin: 0 10px;
            padding: 6px;
            border: 1px solid var(--gray);
            border-radius: 6px;
            font-weight: bold;
        }

        .cart-item-remove {
            color: var(--danger);
            cursor: pointer;
            margin-left: 20px;
            padding: 8px 12px;
            background: rgba(220, 53, 69, 0.1);
            border-radius: 6px;
            transition: all 0.3s;
        }

        .cart-item-remove:hover {
            background: rgba(220, 53, 69, 0.2);
        }

        .cart-total {
            text-align: right;
            font-size: 24px;
            font-weight: bold;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 3px solid var(--gray);
        }

        .checkout-btn {
            background-color: var(--secondary);
            color: var(--dark);
            padding: 18px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 25px;
            transition: all 0.3s;
        }

        .checkout-btn:hover {
            background-color: #d4a320;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(230, 179, 37, 0.3);
        }

        /* Footer */
        footer {
            background-color: var(--dark);
            color: var(--white);
            padding: 50px 0 20px;
            margin-top: 80px;
        }

        .footer-content {
            max-width: 1500px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
        }

        .footer-column h3 {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--secondary);
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column li {
            margin-bottom: 12px;
            cursor: pointer;
            transition: color 0.3s;
        }

        .footer-column li:hover {
            color: var(--secondary);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            margin-top: 40px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 10000;
            display: none;
            max-width: 400px;
        }

        .notification.error {
            background-color: var(--danger);
        }

        .notification.warning {
            background-color: var(--warning);
            color: var(--dark);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state i {
            font-size: 80px;
            margin-bottom: 25px;
            color: var(--accent);
        }

        .empty-state h3 {
            font-size: 24px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        /* User Menu */
        .user-menu {
            position: relative;
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            width: 220px;
            display: none;
            z-index: 1000;
            border: 1px solid var(--gray);
        }

        .user-dropdown.active {
            display: block;
        }

        .user-dropdown-item {
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 1px solid var(--gray);
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text);
        }

        .user-dropdown-item:hover {
            background-color: var(--light);
        }

        .user-dropdown-item:last-child {
            border-bottom: none;
        }

        /* Security Features */
        .security-notice {
            background: linear-gradient(135deg, var(--warning), #ff8c00);
            color: var(--dark);
            padding: 15px;
            text-align: center;
            font-weight: 600;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        /* Admin Panel */
        .admin-panel {
            background: var(--white);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--light);
            border-radius: 8px;
            padding: 25px;
            text-align: center;
            border-left: 4px solid var(--secondary);
        }

        .stat-card h3 {
            font-size: 14px;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
            color: var(--dark);
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: var(--white);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .admin-table th, .admin-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--gray);
        }

        .admin-table th {
            background-color: var(--primary);
            color: var(--white);
            font-weight: 600;
        }

        .admin-table tr:hover {
            background-color: var(--light);
        }

        .action-btns {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .edit-btn {
            background-color: var(--info);
            color: white;
        }

        .delete-btn {
            background-color: var(--danger);
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-1px);
        }

        /* Account Management */
        .account-section {
            background: var(--white);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .account-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: var(--light);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
        }

        .info-card h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        /* Product Detail View */
        .product-detail {
            display: none;
            background: var(--white);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 40px;
        }

        .product-detail.active {
            display: block;
        }

        .product-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 30px;
        }

        .product-detail-images {
            flex: 1;
            max-width: 500px;
            margin-right: 40px;
        }

        .product-detail-main-image {
            height: 400px;
            background: var(--gray);
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .product-detail-main-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            background-color: white;
            padding: 20px;
        }

        .product-detail-thumbnails {
            display: flex;
            gap: 10px;
        }

        .product-detail-thumbnail {
            width: 80px;
            height: 80px;
            border-radius: 6px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid transparent;
        }

        .product-detail-thumbnail.active {
            border-color: var(--accent);
        }

        .product-detail-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-detail-info {
            flex: 1;
        }

        .product-detail-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .product-detail-seller {
            font-size: 16px;
            color: var(--accent);
            margin-bottom: 10px;
        }

        .product-detail-rating {
            color: var(--secondary);
            margin-bottom: 15px;
            font-size: 16px;
        }

        .product-detail-price {
            font-size: 32px;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .product-detail-stock {
            font-size: 16px;
            color: var(--success);
            margin-bottom: 20px;
        }

        .product-detail-description {
            margin-bottom: 30px;
            line-height: 1.8;
        }

        .product-detail-actions {
            display: flex;
            gap: 15px;
        }

        .back-to-products {
            background-color: var(--gray);
            color: var(--text);
            border: none;
            border-radius: 6px;
            padding: 12px 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-to-products:hover {
            background-color: #d8d8d8;
        }

        /* NEW: Enhanced Checkout Modal */
        .checkout-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .checkout-modal-content {
            background: var(--white);
            padding: 30px;
            border-radius: 12px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .checkout-steps {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .checkout-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 20px;
            position: relative;
            z-index: 1;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--gray);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 10px;
            border: 3px solid var(--gray);
            transition: all 0.3s;
        }
        
        .checkout-step.active .step-number {
            background-color: var(--primary);
            color: var(--white);
            border-color: var(--primary);
        }
        
        .checkout-step.completed .step-number {
            background-color: var(--success);
            color: var(--white);
            border-color: var(--success);
        }
        
        .step-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text);
        }
        
        .checkout-step.active .step-label {
            color: var(--primary);
            font-weight: bold;
        }
        
        .checkout-step.completed .step-label {
            color: var(--success);
        }
        
        .checkout-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 50px;
            right: 50px;
            height: 3px;
            background-color: var(--gray);
            z-index: 0;
        }
        
        .checkout-content {
            display: none;
        }
        
        .checkout-content.active {
            display: block;
        }
        
        .checkout-section {
            background: var(--light);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .checkout-section h3 {
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .payment-method {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .payment-option {
            flex: 1;
            border: 2px solid var(--gray);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .payment-option:hover {
            border-color: var(--accent);
        }
        
        .payment-option.selected {
            border-color: var(--primary);
            background-color: rgba(44, 85, 48, 0.05);
        }
        
        .payment-option i {
            font-size: 24px;
            margin-bottom: 10px;
            display: block;
        }
        
        .form-row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }
        
        .order-summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gray);
        }
        
        .order-total {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            font-size: 18px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid var(--gray);
        }
        
        .checkout-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }

        /* NEW: Admin Order Notification */
        .admin-notification {
            position: fixed;
            top: 80px;
            right: 20px;
            background-color: var(--info);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 10000;
            display: none;
            max-width: 400px;
            cursor: pointer;
        }
        
        .admin-notification.warning {
            background-color: var(--warning);
            color: var(--dark);
        }

        /* Order Details in Admin */
        .order-details-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .order-details-content {
            background: var(--white);
            padding: 30px;
            border-radius: 12px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .order-detail-section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--gray);
        }

        .order-detail-section h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .navbar {
                flex-wrap: wrap;
            }
            
            .search-bar {
                order: 3;
                margin: 10px 0;
                max-width: 100%;
            }
            
            .form-row, .form-row-3 {
                grid-template-columns: 1fr;
            }
            
            .secondary-nav ul {
                flex-wrap: wrap;
                gap: 10px;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .cart-item {
                flex-direction: column;
                text-align: center;
            }
            
            .cart-item-image {
                margin-right: 0;
                margin-bottom: 15px;
            }
            
            .cart-item-remove {
                margin-left: 0;
                margin-top: 15px;
            }
            
            .admin-table {
                font-size: 14px;
            }
            
            .action-btns {
                flex-direction: column;
            }
            
            .account-info {
                grid-template-columns: 1fr;
            }
            
            .product-detail-header {
                flex-direction: column;
            }
            
            .product-detail-images {
                max-width: 100%;
                margin-right: 0;
                margin-bottom: 30px;
            }

            .checkout-steps {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .checkout-steps::before {
                display: none;
            }
            
            .checkout-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .payment-method {
                flex-direction: column;
            }
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Logout Confirmation */
        .logout-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .logout-modal-content {
            background: var(--white);
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .logout-modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
        }

        .logout-modal-actions .btn {
            width: auto;
            min-width: 100px;
        }
    </style>
</head>
<body>
    <!-- Authentication Screen -->
    <div id="authScreen">
        <div class="auth-container">
            <div class="auth-header">
                <h1><i class="fas fa-store"></i> Murshid.com</h1>
                <p>Your trusted online marketplace</p>
            </div>
            
            <div class="auth-tabs">
                <div class="auth-tab active" data-form="login">Sign In</div>
                <div class="auth-tab" data-form="register">Create Account</div>
            </div>
            
            <form class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email Address</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="btn btn-primary" id="loginBtn">
                    <span id="loginText">Sign In</span>
                    <div class="loading" id="loginLoading" style="display: none;"></div>
                </button>
            </form>
            
            <form class="auth-form" id="registerForm">
                <div class="form-group">
                    <label for="registerName">Full Name</label>
                    <input type="text" id="registerName" placeholder="Enter your full name" required>
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email Address</label>
                    <input type="email" id="registerEmail" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" placeholder="Create a password" required minlength="6">
                </div>
                <div class="form-group">
                    <label for="registerConfirmPassword">Confirm Password</label>
                    <input type="password" id="registerConfirmPassword" placeholder="Confirm your password" required>
                </div>
                <button type="submit" class="btn btn-primary" id="registerBtn">
                    <span id="registerText">Create Account</span>
                    <div class="loading" id="registerLoading" style="display: none;"></div>
                </button>
            </form>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div class="logout-modal" id="logoutModal">
        <div class="logout-modal-content">
            <i class="fas fa-sign-out-alt" style="font-size: 48px; color: var(--warning); margin-bottom: 20px;"></i>
            <h3>Confirm Sign Out</h3>
            <p>Are you sure you want to sign out of your account?</p>
            <div class="logout-modal-actions">
                <button class="btn btn-secondary" id="cancelLogout">Cancel</button>
                <button class="btn btn-primary" id="confirmLogout">Sign Out</button>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div class="order-details-modal" id="orderDetailsModal">
        <div class="order-details-content">
            <h2 class="section-title">Order Details</h2>
            <div id="orderDetailsContent">
                <!-- Order details will be loaded here -->
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="hideOrderDetails()">Close</button>
            </div>
        </div>
    </div>

    <!-- NEW: Enhanced Checkout Modal -->
    <div class="checkout-modal" id="checkoutModal">
        <div class="checkout-modal-content">
            <h2 class="section-title">Checkout</h2>
            
            <div class="checkout-steps">
                <div class="checkout-step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">Shipping</div>
                </div>
                <div class="checkout-step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">Payment</div>
                </div>
                <div class="checkout-step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">Review</div>
                </div>
            </div>
            
            <!-- Step 1: Shipping Address -->
            <div class="checkout-content active" id="checkout-step-1">
                <div class="checkout-section">
                    <h3>Shipping Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="shippingFirstName">First Name *</label>
                            <input type="text" id="shippingFirstName" placeholder="Enter first name" required>
                        </div>
                        <div class="form-group">
                            <label for="shippingLastName">Last Name *</label>
                            <input type="text" id="shippingLastName" placeholder="Enter last name" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="shippingAddress">Street Address *</label>
                        <input type="text" id="shippingAddress" placeholder="Enter street address" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="shippingCity">City *</label>
                            <input type="text" id="shippingCity" placeholder="Enter city" required>
                        </div>
                        <div class="form-group">
                            <label for="shippingState">State/Province *</label>
                            <input type="text" id="shippingState" placeholder="Enter state" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="shippingZip">ZIP/Postal Code *</label>
                            <input type="text" id="shippingZip" placeholder="Enter ZIP code" required>
                        </div>
                        <div class="form-group">
                            <label for="shippingCountry">Country *</label>
                            <select id="shippingCountry" required>
                                <option value="">Select Country</option>
                                <option value="US">United States</option>
                                <option value="CA">Canada</option>
                                <option value="UK">United Kingdom</option>
                                <option value="AU">Australia</option>
                                <option value="DE">Germany</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="shippingPhone">Phone Number *</label>
                        <input type="tel" id="shippingPhone" placeholder="Enter phone number" required>
                    </div>
                    <div class="form-group">
                        <label for="shippingEmail">Email Address *</label>
                        <input type="email" id="shippingEmail" placeholder="Enter email for updates" required>
                    </div>
                </div>
                
                <div class="checkout-actions">
                    <button class="btn btn-secondary" onclick="hideCheckoutModal()">
                        <i class="fas fa-arrow-left"></i> Back to Cart
                    </button>
                    <button class="btn btn-primary" onclick="validateShippingAndProceed()">
                        Continue to Payment <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 2: Payment Method -->
            <div class="checkout-content" id="checkout-step-2">
                <div class="checkout-section">
                    <h3>Payment Method</h3>
                    <div class="payment-method">
                        <div class="payment-option selected" data-method="card">
                            <i class="fas fa-credit-card"></i>
                            <div>Credit/Debit Card</div>
                        </div>
                        <div class="payment-option" data-method="paypal">
                            <i class="fab fa-paypal"></i>
                            <div>PayPal</div>
                        </div>
                        <div class="payment-option" data-method="cash">
                            <i class="fas fa-money-bill-wave"></i>
                            <div>Cash on Delivery</div>
                        </div>
                    </div>
                    
                    <!-- Card Payment Form -->
                    <div id="cardPaymentForm">
                        <div class="form-group">
                            <label for="cardNumber">Card Number *</label>
                            <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cardName">Name on Card *</label>
                                <input type="text" id="cardName" placeholder="Enter name as on card">
                            </div>
                            <div class="form-group">
                                <label for="cardExpiry">Expiry Date *</label>
                                <input type="text" id="cardExpiry" placeholder="MM/YY" maxlength="5">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cardCVV">CVV *</label>
                                <input type="text" id="cardCVV" placeholder="123" maxlength="4">
                            </div>
                            <div class="form-group">
                                <label for="saveCard">Save card for future purchases</label>
                                <input type="checkbox" id="saveCard" style="width: auto; margin-top: 5px;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- PayPal Notice -->
                    <div id="paypalNotice" style="display: none;">
                        <div class="security-notice">
                            <i class="fab fa-paypal"></i>
                            You will be redirected to PayPal to complete your payment after order review.
                        </div>
                    </div>
                    
                    <!-- Cash on Delivery Notice -->
                    <div id="cashNotice" style="display: none;">
                        <div class="security-notice">
                            <i class="fas fa-money-bill-wave"></i>
                            Pay with cash when your order is delivered. Additional $2.00 fee applies.
                        </div>
                    </div>
                </div>
                
                <div class="checkout-actions">
                    <button class="btn btn-secondary" onclick="goToCheckoutStep(1)">
                        <i class="fas fa-arrow-left"></i> Back to Shipping
                    </button>
                    <button class="btn btn-primary" onclick="validatePaymentAndProceed()">
                        Continue to Review <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Step 3: Order Review -->
            <div class="checkout-content" id="checkout-step-3">
                <div class="checkout-section">
                    <h3>Order Summary</h3>
                    <div id="orderReviewItems">
                        <!-- Order items will be loaded here -->
                    </div>
                    
                    <div class="order-summary-item">
                        <span>Items:</span>
                        <span id="reviewItemsTotal">$0.00</span>
                    </div>
                    <div class="order-summary-item">
                        <span>Shipping:</span>
                        <span id="reviewShipping">$5.99</span>
                    </div>
                    <div class="order-summary-item">
                        <span>Tax:</span>
                        <span id="reviewTax">$0.00</span>
                    </div>
                    <div class="order-total">
                        <span>Order Total:</span>
                        <span id="reviewOrderTotal">$0.00</span>
                    </div>
                </div>
                
                <div class="checkout-section">
                    <h3>Shipping Details</h3>
                    <div id="reviewShippingDetails">
                        <!-- Shipping details will be loaded here -->
                    </div>
                </div>
                
                <div class="checkout-section">
                    <h3>Payment Method</h3>
                    <div id="reviewPaymentDetails">
                        <!-- Payment details will be loaded here -->
                    </div>
                </div>
                
                <div class="checkout-actions">
                    <button class="btn btn-secondary" onclick="goToCheckoutStep(2)">
                        <i class="fas fa-arrow-left"></i> Back to Payment
                    </button>
                    <button class="btn btn-primary" onclick="placeOrder()">
                        <i class="fas fa-shopping-bag"></i> Place Your Order
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: Admin Order Notification -->
    <div class="admin-notification" id="adminOrderNotification">
        <div id="adminNotificationContent">
            <!-- Admin notifications will appear here -->
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp">
        <!-- Header -->
        <header>
            <div class="navbar">
                <a href="#" class="logo">
                    <i class="fas fa-store"></i>
                    Murshid.com
                </a>
                
                <div class="search-bar">
                    <select id="searchCategory">
                        <option value="all">All Categories</option>
                        <option value="electronics">Electronics</option>
                        <option value="fashion">Fashion</option>
                        <option value="home">Home & Kitchen</option>
                        <option value="books">Books</option>
                        <option value="sports">Sports & Outdoors</option>
                    </select>
                    <input type="text" id="searchInput" placeholder="Search for products, brands and more">
                    <button id="searchButton"><i class="fas fa-search"></i></button>
                </div>
                
                <div class="nav-links">
                    <div class="nav-item user-menu" id="userAccount">
                        <div id="userGreeting">Hello, User</div>
                        <div><strong id="userAccountText">Account</strong></div>
                        <div class="user-dropdown" id="userDropdown">
                            <div class="user-dropdown-item" id="profileLink">
                                <i class="fas fa-user"></i> Your Profile
                            </div>
                            <div class="user-dropdown-item" id="accountSettingsLink">
                                <i class="fas fa-cog"></i> Account Settings
                            </div>
                            <div class="user-dropdown-item" id="ordersLink">
                                <i class="fas fa-shopping-bag"></i> Your Orders
                            </div>
                            <div class="user-dropdown-item" id="sellLink" style="display: none;">
                                <i class="fas fa-plus-circle"></i> Sell Products
                            </div>
                            <div class="user-dropdown-item" id="adminLink" style="display: none;">
                                <i class="fas fa-cog"></i> Admin Panel
                            </div>
                            <div class="user-dropdown-item" id="wishlistLink">
                                <i class="fas fa-heart"></i> Your Wishlist
                            </div>
                            <div class="user-dropdown-item" id="logoutLink">
                                <i class="fas fa-sign-out-alt"></i> Sign Out
                            </div>
                        </div>
                    </div>
                    <div class="nav-item cart" id="cartLink">
                        <i class="fas fa-shopping-cart fa-lg"></i>
                        <div class="cart-count" id="cartCount">0</div>
                        <div><strong>Cart</strong></div>
                    </div>
                </div>
            </div>
            
            <div class="secondary-nav">
                <ul>
                    <li class="active" data-tab="browse">
                        <i class="fas fa-home"></i> Browse Products
                    </li>
                    <li data-tab="sell" id="sellNav" style="display: none;">
                        <i class="fas fa-plus-circle"></i> Sell on Murshid
                    </li>
                    <li data-tab="admin" id="adminNav" style="display: none;">
                        <i class="fas fa-cog"></i> Admin Panel
                    </li>
                    <li data-tab="account" id="accountNav">
                        <i class="fas fa-user"></i> My Account
                    </li>
                    <li data-tab="cart">
                        <i class="fas fa-shopping-cart"></i> Your Cart
                    </li>
                </ul>
            </div>
        </header>

        <!-- Notification -->
        <div class="notification" id="notification"></div>

        <!-- Main Content -->
        <div class="container">
            <!-- Browse Products Tab -->
            <div class="tab-content active" id="browse-tab">
                <h2 class="section-title">Featured Products</h2>
                
                <div class="products-grid" id="productsGrid">
                    <!-- Products will be loaded here -->
                </div>
                
                <div class="empty-state" id="noProductsMessage" style="display: none;">
                    <i class="fas fa-box-open"></i>
                    <h3>No Products Available</h3>
                    <p>Be the first to list a product!</p>
                </div>
            </div>
            
            <!-- Product Detail View -->
            <div class="product-detail" id="productDetail">
                <div class="product-detail-header">
                    <div class="product-detail-images">
                        <div class="product-detail-main-image" id="productDetailMainImage">
                            <i class="fas fa-box no-image" style="font-size: 80px;"></i>
                        </div>
                        <div class="product-detail-thumbnails" id="productDetailThumbnails">
                            <!-- Thumbnails will be added here -->
                        </div>
                    </div>
                    <div class="product-detail-info">
                        <h1 class="product-detail-title" id="productDetailTitle">Product Title</h1>
                        <div class="product-detail-seller" id="productDetailSeller">Sold by: Seller</div>
                        <div class="product-detail-rating" id="productDetailRating">
                            <i class="far fa-star"></i> No reviews yet
                        </div>
                        <div class="product-detail-price" id="productDetailPrice">$0.00</div>
                        <div class="product-detail-stock" id="productDetailStock">In Stock</div>
                        <div class="product-detail-description" id="productDetailDescription">
                            Product description will appear here.
                        </div>
                        <div class="product-detail-actions">
                            <button class="add-to-cart" id="productDetailAddToCart">Add to Cart</button>
                            <button class="buy-now" id="productDetailBuyNow">Buy Now</button>
                        </div>
                    </div>
                </div>
                <button class="back-to-products" id="backToProducts">
                    <i class="fas fa-arrow-left"></i> Back to Products
                </button>
            </div>
            
            <!-- Sell on Murshid Tab -->
            <div class="tab-content" id="sell-tab">
                <h2 class="section-title">List Your Product</h2>
                
                <div class="security-notice">
                    <i class="fas fa-shield-alt"></i>
                    Product listing privileges are restricted to authorized users only
                </div>
                
                <div class="form-container">
                    <div class="form-group">
                        <label for="productName">Product Name *</label>
                        <input type="text" id="productName" placeholder="Enter product name" maxlength="100">
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="category">Category *</label>
                            <select id="category">
                                <option value="">Select Category</option>
                                <option value="electronics">Electronics</option>
                                <option value="fashion">Fashion</option>
                                <option value="home">Home & Kitchen</option>
                                <option value="books">Books</option>
                                <option value="sports">Sports & Outdoors</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="price">Price ($) *</label>
                            <input type="number" id="price" placeholder="0.00" step="0.01" min="0" max="100000">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="description">Product Description *</label>
                        <textarea id="description" placeholder="Describe your product in detail" maxlength="1000"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="stock">Stock Quantity *</label>
                            <input type="number" id="stock" placeholder="0" min="1" max="10000">
                        </div>
                        
                        <div class="form-group">
                            <label for="brand">Brand *</label>
                            <input type="text" id="brand" placeholder="Product brand" maxlength="50">
                        </div>
                    </div>
                    
                    <!-- Image Upload Section -->
                    <div class="form-group">
                        <label>Product Images (Max 5 images)</label>
                        <div class="image-upload" id="imageUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Click to upload product images</p>
                            <p class="small" style="font-size: 12px; margin-top: 5px; opacity: 0.7;">
                                Supported formats: JPG, PNG, GIF • Max size: 2MB per image
                            </p>
                            <input type="file" id="imageInput" accept="image/*" multiple style="display: none;">
                        </div>
                        <div class="image-preview" id="imagePreview"></div>
                    </div>
                    
                    <div class="form-actions">
                        <button class="btn btn-secondary" id="cancelBtn">Cancel</button>
                        <button class="btn btn-primary" id="addProductBtn">List Product</button>
                    </div>
                </div>
            </div>

            <!-- Admin Panel Tab -->
            <div class="tab-content" id="admin-tab">
                <h2 class="section-title">Admin Panel</h2>
                
                <div class="admin-panel">
                    <div class="admin-stats">
                        <div class="stat-card">
                            <h3>TOTAL USERS</h3>
                            <div class="value" id="totalUsers">0</div>
                        </div>
                        <div class="stat-card">
                            <h3>TOTAL PRODUCTS</h3>
                            <div class="value" id="totalProducts">0</div>
                        </div>
                        <div class="stat-card">
                            <h3>TOTAL ORDERS</h3>
                            <div class="value" id="totalOrders">0</div>
                        </div>
                        <div class="stat-card">
                            <h3>REVENUE</h3>
                            <div class="value" id="totalRevenue">$0.00</div>
                        </div>
                    </div>
                    
                    <h3>Product Management</h3>
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Stock</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminProductsTable">
                            <!-- Products will be dynamically added here -->
                        </tbody>
                    </table>
                    
                    <h3 style="margin-top: 30px;">User Management</h3>
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Joined</th>
                            </tr>
                        </thead>
                        <tbody id="adminUsersTable">
                            <!-- Users will be dynamically added here -->
                        </tbody>
                    </table>

                    <!-- NEW: Enhanced Orders Section in Admin Panel -->
                    <h3 style="margin-top: 30px;">Recent Orders</h3>
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Date</th>
                                <th>Total</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminOrdersTable">
                            <!-- Orders will be dynamically added here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Account Management Tab -->
            <div class="tab-content" id="account-tab">
                <h2 class="section-title">My Account</h2>
                
                <div class="account-section">
                    <h3>Account Information</h3>
                    <div class="account-info">
                        <div class="info-card">
                            <h4>Personal Details</h4>
                            <p><strong>Name:</strong> <span id="accountName">-</span></p>
                            <p><strong>Email:</strong> <span id="accountEmail">-</span></p>
                            <p><strong>Role:</strong> <span id="accountRole">-</span></p>
                            <p><strong>Member since:</strong> <span id="accountSince">-</span></p>
                        </div>
                        <div class="info-card">
                            <h4>Account Statistics</h4>
                            <p><strong>Orders Placed:</strong> <span id="accountOrders">0</span></p>
                            <p><strong>Products Listed:</strong> <span id="accountProducts">0</span></p>
                            <p><strong>Cart Items:</strong> <span id="accountCartItems">0</span></p>
                        </div>
                    </div>
                </div>

                <div class="account-section">
                    <h3>Update Profile</h3>
                    <div class="form-container">
                        <div class="form-group">
                            <label for="updateName">Full Name</label>
                            <input type="text" id="updateName" placeholder="Enter your full name">
                        </div>
                        <div class="form-group">
                            <label for="updateEmail">Email Address</label>
                            <input type="email" id="updateEmail" placeholder="Enter your email">
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" id="updateProfileBtn">Update Profile</button>
                        </div>
                    </div>
                </div>

                <div class="account-section">
                    <h3>Change Password</h3>
                    <div class="form-container">
                        <div class="form-group">
                            <label for="currentPassword">Current Password</label>
                            <input type="password" id="currentPassword" placeholder="Enter current password">
                        </div>
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <input type="password" id="newPassword" placeholder="Enter new password" minlength="6">
                        </div>
                        <div class="form-group">
                            <label for="confirmNewPassword">Confirm New Password</label>
                            <input type="password" id="confirmNewPassword" placeholder="Confirm new password">
                        </div>
                        <div class="form-actions">
                            <button class="btn btn-primary" id="changePasswordBtn">Change Password</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Cart Tab -->
            <div class="tab-content" id="cart-tab">
                <h2 class="section-title">Your Shopping Cart</h2>
                
                <div id="cartItems">
                    <!-- Cart items will be loaded here -->
                </div>
                
                <div class="empty-state" id="emptyCart" style="display: none;">
                    <i class="fas fa-shopping-cart"></i>
                    <h3>Your Cart is Empty</h3>
                    <p>Add some products to your cart to continue shopping.</p>
                    <button class="btn btn-primary" style="margin-top: 20px;" onclick="switchTab('browse')">
                        Browse Products
                    </button>
                </div>
                
                <div class="cart-total" id="cartTotal" style="display: none;">
                    Total: $<span id="totalAmount">0.00</span>
                </div>
                
                <button class="checkout-btn" id="checkoutBtn" style="display: none;">
                    <i class="fas fa-lock"></i> Proceed to Checkout
                </button>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Get to Know Us</h3>
                    <ul>
                        <li>About Murshid</li>
                        <li>Careers</li>
                        <li>Press Releases</li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Make Money with Us</h3>
                    <ul>
                        <li>Sell on Murshid</li>
                        <li>Become an Affiliate</li>
                        <li>Advertise Your Products</li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3>Let Us Help You</h3>
                    <ul>
                        <li>Your Account</li>
                        <li>Returns Centre</li>
                        <li>Help & Support</li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2023 Murshid.com. All rights reserved. | <a href="#" style="color: var(--secondary);">Privacy Policy</a> | <a href="#" style="color: var(--secondary);">Terms of Service</a></p>
            </div>
        </footer>
    </div>

    <script>
        // Security Configuration
        const SECURITY_CONFIG = {
            adminEmail: 'rashidsliq@gmail.com',
            maxImageSize: 2 * 1024 * 1024, // 2MB
            maxImages: 5,
            allowedImageTypes: ['image/jpeg', 'image/png', 'image/gif', 'image/webp']
        };

        // Data storage with enhanced security
        let users = JSON.parse(localStorage.getItem('murshid_users')) || [];
        let products = JSON.parse(localStorage.getItem('murshid_products')) || [];
        let cart = JSON.parse(localStorage.getItem('murshid_cart')) || [];
        let orders = JSON.parse(localStorage.getItem('murshid_orders')) || [];
        let currentUser = JSON.parse(localStorage.getItem('murshid_currentUser')) || null;
        let currentProductDetail = null;

        // NEW: Checkout variables
        let currentCheckoutStep = 1;
        let selectedPaymentMethod = 'card';
        let checkoutData = {
            shipping: {},
            payment: {},
            order: {}
        };

        // DOM elements
        const authScreen = document.getElementById('authScreen');
        const mainApp = document.getElementById('mainApp');
        const productsGrid = document.getElementById('productsGrid');
        const cartItems = document.getElementById('cartItems');
        const cartCount = document.getElementById('cartCount');
        const cartTotal = document.getElementById('cartTotal');
        const totalAmount = document.getElementById('totalAmount');
        const checkoutBtn = document.getElementById('checkoutBtn');
        const emptyCart = document.getElementById('emptyCart');
        const noProductsMessage = document.getElementById('noProductsMessage');
        const notification = document.getElementById('notification');
        const sellNav = document.getElementById('sellNav');
        const adminNav = document.getElementById('adminNav');
        const sellLink = document.getElementById('sellLink');
        const adminLink = document.getElementById('adminLink');
        const logoutModal = document.getElementById('logoutModal');
        const productDetail = document.getElementById('productDetail');
        const backToProducts = document.getElementById('backToProducts');

        // NEW: Checkout modal elements
        const checkoutModal = document.getElementById('checkoutModal');
        const adminOrderNotification = document.getElementById('adminOrderNotification');
        const orderDetailsModal = document.getElementById('orderDetailsModal');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initializing application...');
            initializeApp();
            setupEventListeners();
            checkAuthentication();
        });

        // Initialize application - NO FAKE PRODUCTS
        function initializeApp() {
            console.log('Initializing app data...');
            
            // Clear any old data and create fresh admin user
            localStorage.removeItem('murshid_users');
            localStorage.removeItem('murshid_products');
            localStorage.removeItem('murshid_cart');
            localStorage.removeItem('murshid_orders');
            localStorage.removeItem('murshid_currentUser');
            
            users = [];
            products = [];
            cart = [];
            orders = [];
            currentUser = null;
            
            // Create admin user
            console.log('Creating admin user...');
            users.push({
                id: generateId(),
                name: 'Admin User',
                email: SECURITY_CONFIG.adminEmail,
                password: 'admin123',
                role: 'admin',
                createdAt: new Date().toISOString()
            });
            
            // NO SAMPLE PRODUCTS - Start with empty marketplace
            saveData();
            console.log('Admin user created:', SECURITY_CONFIG.adminEmail);
            console.log('Marketplace initialized with no products');
        }

        // Setup event listeners
        function setupEventListeners() {
            console.log('Setting up event listeners...');
            
            // Auth tabs
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    console.log('Switching auth tab to:', this.getAttribute('data-form'));
                    switchAuthTab(this.getAttribute('data-form'));
                });
            });

            // Auth forms
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                console.log('Login form submitted');
                handleLogin();
            });
            
            document.getElementById('registerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                console.log('Register form submitted');
                handleRegister();
            });

            // Navigation
            document.querySelectorAll('.secondary-nav li').forEach(item => {
                item.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    console.log('Switching to tab:', tabName);
                    if ((tabName === 'sell' || tabName === 'admin') && !hasSellingPrivileges()) {
                        showNotification('Access restricted to admin users only', 'warning');
                        return;
                    }
                    switchTab(tabName);
                });
            });

            // User dropdown
            document.getElementById('userAccount').addEventListener('click', function(e) {
                console.log('User account clicked');
                const dropdown = document.getElementById('userDropdown');
                dropdown.classList.toggle('active');
                e.stopPropagation();
            });

            // User dropdown items
            document.getElementById('logoutLink').addEventListener('click', showLogoutConfirmation);
            document.getElementById('sellLink').addEventListener('click', function() {
                console.log('Sell link clicked');
                switchTab('sell');
                document.getElementById('userDropdown').classList.remove('active');
            });
            document.getElementById('adminLink').addEventListener('click', function() {
                console.log('Admin link clicked');
                switchTab('admin');
                document.getElementById('userDropdown').classList.remove('active');
            });
            document.getElementById('profileLink').addEventListener('click', function() {
                console.log('Profile link clicked');
                switchTab('account');
                document.getElementById('userDropdown').classList.remove('active');
            });
            document.getElementById('accountSettingsLink').addEventListener('click', function() {
                console.log('Account settings clicked');
                switchTab('account');
                document.getElementById('userDropdown').classList.remove('active');
            });
            document.getElementById('ordersLink').addEventListener('click', function() {
                console.log('Orders link clicked');
                showNotification('Order history feature coming soon!', 'info');
                document.getElementById('userDropdown').classList.remove('active');
            });
            document.getElementById('wishlistLink').addEventListener('click', function() {
                console.log('Wishlist link clicked');
                showNotification('Wishlist feature coming soon!', 'info');
                document.getElementById('userDropdown').classList.remove('active');
            });

            // Logout modal
            document.getElementById('cancelLogout').addEventListener('click', hideLogoutConfirmation);
            document.getElementById('confirmLogout').addEventListener('click', handleLogout);

            // Close dropdown when clicking outside
            document.addEventListener('click', function() {
                document.getElementById('userDropdown').classList.remove('active');
            });

            // Search functionality
            document.getElementById('searchButton').addEventListener('click', performSearch);
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') performSearch();
            });

            // Product management
            document.getElementById('addProductBtn').addEventListener('click', handleAddProduct);
            document.getElementById('cancelBtn').addEventListener('click', resetProductForm);

            // Image upload
            document.getElementById('imageUpload').addEventListener('click', function() {
                document.getElementById('imageInput').click();
            });
            document.getElementById('imageInput').addEventListener('change', handleImageUpload);

            // Cart functionality
            document.getElementById('checkoutBtn').addEventListener('click', function() {
                showCheckoutModal();
            });
            document.getElementById('cartLink').addEventListener('click', function() {
                switchTab('cart');
            });

            // Account management
            document.getElementById('updateProfileBtn').addEventListener('click', updateProfile);
            document.getElementById('changePasswordBtn').addEventListener('click', changePassword);
            
            // Product detail functionality
            document.getElementById('backToProducts').addEventListener('click', function() {
                productDetail.classList.remove('active');
                document.getElementById('browse-tab').classList.add('active');
            });
            
            document.getElementById('productDetailAddToCart').addEventListener('click', function() {
                if (currentProductDetail) {
                    addToCart(currentProductDetail.id);
                }
            });
            
            document.getElementById('productDetailBuyNow').addEventListener('click', function() {
                if (currentProductDetail) {
                    addToCart(currentProductDetail.id);
                    switchTab('cart');
                }
            });

            // NEW: Payment method selection
            document.querySelectorAll('.payment-option').forEach(option => {
                option.addEventListener('click', function() {
                    selectPaymentMethod(this.getAttribute('data-method'));
                });
            });

            // NEW: Admin notification click
            adminOrderNotification.addEventListener('click', function() {
                if (hasSellingPrivileges()) {
                    switchTab('admin');
                    this.style.display = 'none';
                }
            });

            // NEW: Card number formatting
            document.getElementById('cardNumber').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
                let matches = value.match(/\d{4,16}/g);
                let match = matches && matches[0] || '';
                let parts = [];
                
                for (let i = 0; i < match.length; i += 4) {
                    parts.push(match.substring(i, i + 4));
                }
                
                if (parts.length) {
                    e.target.value = parts.join(' ');
                } else {
                    e.target.value = value;
                }
            });

            // NEW: Expiry date formatting
            document.getElementById('cardExpiry').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length >= 2) {
                    e.target.value = value.substring(0, 2) + '/' + value.substring(2, 4);
                }
            });
            
            console.log('Event listeners setup complete');
        }

        // NEW: Select payment method
        function selectPaymentMethod(method) {
            selectedPaymentMethod = method;
            
            // Update UI
            document.querySelectorAll('.payment-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`.payment-option[data-method="${method}"]`).classList.add('selected');
            
            // Show/hide relevant forms
            document.getElementById('cardPaymentForm').style.display = method === 'card' ? 'block' : 'none';
            document.getElementById('paypalNotice').style.display = method === 'paypal' ? 'block' : 'none';
            document.getElementById('cashNotice').style.display = method === 'cash' ? 'block' : 'none';
        }

        // NEW: Show checkout modal
        function showCheckoutModal() {
            const userCart = cart.filter(item => item.userId === currentUser.id);
            if (userCart.length === 0) {
                showNotification('Your cart is empty', 'error');
                return;
            }
            
            // Reset checkout to step 1
            currentCheckoutStep = 1;
            renderCheckoutStep(1);
            
            // Pre-fill user information
            if (currentUser) {
                document.getElementById('shippingEmail').value = currentUser.email;
                const nameParts = currentUser.name.split(' ');
                if (nameParts.length > 0) {
                    document.getElementById('shippingFirstName').value = nameParts[0];
                    if (nameParts.length > 1) {
                        document.getElementById('shippingLastName').value = nameParts.slice(1).join(' ');
                    }
                }
            }
            
            checkoutModal.style.display = 'flex';
        }

        // NEW: Hide checkout modal
        function hideCheckoutModal() {
            checkoutModal.style.display = 'none';
            // Reset checkout data
            checkoutData = {
                shipping: {},
                payment: {},
                order: {}
            };
        }

        // NEW: Validate shipping and proceed to payment
        function validateShippingAndProceed() {
            const shippingData = {
                firstName: document.getElementById('shippingFirstName').value.trim(),
                lastName: document.getElementById('shippingLastName').value.trim(),
                address: document.getElementById('shippingAddress').value.trim(),
                city: document.getElementById('shippingCity').value.trim(),
                state: document.getElementById('shippingState').value.trim(),
                zip: document.getElementById('shippingZip').value.trim(),
                country: document.getElementById('shippingCountry').value,
                phone: document.getElementById('shippingPhone').value.trim(),
                email: document.getElementById('shippingEmail').value.trim()
            };
            
            // Validate required fields
            const requiredFields = ['firstName', 'lastName', 'address', 'city', 'state', 'zip', 'country', 'phone', 'email'];
            for (let field of requiredFields) {
                if (!shippingData[field]) {
                    showNotification(`Please fill in all shipping information`, 'error');
                    return;
                }
            }
            
            // Validate email
            if (!isValidEmail(shippingData.email)) {
                showNotification('Please enter a valid email address', 'error');
                return;
            }
            
            // Validate phone (basic validation)
            if (shippingData.phone.replace(/\D/g, '').length < 10) {
                showNotification('Please enter a valid phone number', 'error');
                return;
            }
            
            // Save shipping data
            checkoutData.shipping = shippingData;
            
            // Proceed to payment
            goToCheckoutStep(2);
        }

        // NEW: Validate payment and proceed to review
        function validatePaymentAndProceed() {
            let paymentData = {
                method: selectedPaymentMethod
            };
            
            if (selectedPaymentMethod === 'card') {
                paymentData.card = {
                    number: document.getElementById('cardNumber').value.replace(/\s/g, ''),
                    name: document.getElementById('cardName').value.trim(),
                    expiry: document.getElementById('cardExpiry').value,
                    cvv: document.getElementById('cardCVV').value,
                    save: document.getElementById('saveCard').checked
                };
                
                // Validate card details
                if (!paymentData.card.number || paymentData.card.number.replace(/\D/g, '').length < 16) {
                    showNotification('Please enter a valid card number', 'error');
                    return;
                }
                
                if (!paymentData.card.name) {
                    showNotification('Please enter the name on card', 'error');
                    return;
                }
                
                if (!paymentData.card.expiry || !paymentData.card.expiry.match(/^\d{2}\/\d{2}$/)) {
                    showNotification('Please enter a valid expiry date (MM/YY)', 'error');
                    return;
                }
                
                if (!paymentData.card.cvv || paymentData.card.cvv.length < 3) {
                    showNotification('Please enter a valid CVV', 'error');
                    return;
                }
                
                // Mask card number for security (only show last 4 digits)
                paymentData.card.displayNumber = '**** **** **** ' + paymentData.card.number.slice(-4);
            }
            
            // Save payment data
            checkoutData.payment = paymentData;
            
            // Render order review
            renderOrderReview();
            
            // Proceed to review
            goToCheckoutStep(3);
        }

        // NEW: Render checkout steps
        function renderCheckoutStep(step) {
            currentCheckoutStep = step;
            
            // Update step indicators
            document.querySelectorAll('.checkout-step').forEach(stepEl => {
                const stepNum = parseInt(stepEl.getAttribute('data-step'));
                stepEl.classList.remove('active', 'completed');
                
                if (stepNum === step) {
                    stepEl.classList.add('active');
                } else if (stepNum < step) {
                    stepEl.classList.add('completed');
                }
            });
            
            // Show current step content
            document.querySelectorAll('.checkout-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`checkout-step-${step}`).classList.add('active');
        }

        // NEW: Go to specific checkout step
        function goToCheckoutStep(step) {
            renderCheckoutStep(step);
        }

        // NEW: Render order review
        function renderOrderReview() {
            const userCart = cart.filter(item => item.userId === currentUser.id);
            const itemsContainer = document.getElementById('orderReviewItems');
            const shippingContainer = document.getElementById('reviewShippingDetails');
            const paymentContainer = document.getElementById('reviewPaymentDetails');
            
            // Render items
            itemsContainer.innerHTML = '';
            let itemsTotal = 0;
            
            userCart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                itemsTotal += itemTotal;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'order-summary-item';
                itemElement.innerHTML = `
                    <div>
                        <strong>${item.name}</strong>
                        <div>Qty: ${item.quantity}</div>
                    </div>
                    <div>$${itemTotal.toFixed(2)}</div>
                `;
                itemsContainer.appendChild(itemElement);
            });
            
            // Calculate totals
            let shipping = itemsTotal > 0 ? 5.99 : 0; // Flat rate shipping
            if (selectedPaymentMethod === 'cash') {
                shipping += 2.00; // Additional fee for cash on delivery
            }
            const tax = itemsTotal * 0.08; // 8% tax
            const orderTotal = itemsTotal + shipping + tax;
            
            document.getElementById('reviewItemsTotal').textContent = `$${itemsTotal.toFixed(2)}`;
            document.getElementById('reviewShipping').textContent = `$${shipping.toFixed(2)}`;
            document.getElementById('reviewTax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('reviewOrderTotal').textContent = `$${orderTotal.toFixed(2)}`;
            
            // Render shipping details
            shippingContainer.innerHTML = `
                <p><strong>${checkoutData.shipping.firstName} ${checkoutData.shipping.lastName}</strong></p>
                <p>${checkoutData.shipping.address}</p>
                <p>${checkoutData.shipping.city}, ${checkoutData.shipping.state} ${checkoutData.shipping.zip}</p>
                <p>${checkoutData.shipping.country}</p>
                <p>Phone: ${checkoutData.shipping.phone}</p>
                <p>Email: ${checkoutData.shipping.email}</p>
            `;
            
            // Render payment details
            let paymentHtml = '';
            if (selectedPaymentMethod === 'card') {
                paymentHtml = `
                    <p><strong>Credit/Debit Card</strong></p>
                    <p>Card: ${checkoutData.payment.card.displayNumber}</p>
                    <p>Name: ${checkoutData.payment.card.name}</p>
                    <p>Expires: ${checkoutData.payment.card.expiry}</p>
                `;
            } else if (selectedPaymentMethod === 'paypal') {
                paymentHtml = `
                    <p><strong>PayPal</strong></p>
                    <p>You will complete payment through PayPal</p>
                `;
            } else if (selectedPaymentMethod === 'cash') {
                paymentHtml = `
                    <p><strong>Cash on Delivery</strong></p>
                    <p>Pay with cash when your order is delivered</p>
                    <p><em>Additional $2.00 fee applied</em></p>
                `;
            }
            paymentContainer.innerHTML = paymentHtml;
            
            // Save order data
            checkoutData.order = {
                itemsTotal: itemsTotal,
                shipping: shipping,
                tax: tax,
                total: orderTotal
            };
        }

        // NEW: Enhanced place order function with real data
        function placeOrder() {
            const userCart = cart.filter(item => item.userId === currentUser.id);
            if (userCart.length === 0) {
                showNotification('Your cart is empty', 'error');
                return;
            }
            
            // Create order with all details
            const order = {
                id: generateId(),
                userId: currentUser.id,
                customerName: currentUser.name,
                customerEmail: currentUser.email,
                items: userCart.map(item => ({
                    productId: item.productId,
                    name: item.name,
                    price: item.price,
                    quantity: item.quantity,
                    seller: item.seller,
                    itemTotal: item.price * item.quantity
                })),
                shipping: checkoutData.shipping,
                payment: checkoutData.payment,
                subtotal: checkoutData.order.itemsTotal,
                shippingCost: checkoutData.order.shipping,
                tax: checkoutData.order.tax,
                total: checkoutData.order.total,
                status: 'confirmed',
                date: new Date().toISOString(),
                orderNumber: 'MUR' + Date.now().toString().slice(-6)
            };
            
            // Add to orders
            orders.push(order);
            
            // Update product stock
            userCart.forEach(cartItem => {
                const product = products.find(p => p.id === cartItem.productId);
                if (product) {
                    product.stock -= cartItem.quantity;
                }
            });
            
            // Clear user's cart
            cart = cart.filter(item => item.userId !== currentUser.id);
            
            // Save data
            saveData();
            
            // Show admin notification if admin is logged in
            showAdminOrderNotification(order);
            
            // Hide checkout modal
            hideCheckoutModal();
            
            // Update cart
            renderCart();
            updateCartCount();
            
            // Show success message
            showNotification(`Order #${order.orderNumber} placed successfully! Total: $${order.total.toFixed(2)}`);
            
            // Switch to browse tab
            switchTab('browse');
        }

        // NEW: Show admin order notification with detailed information
        function showAdminOrderNotification(order) {
            // Check if admin is logged in
            if (hasSellingPrivileges()) {
                const contentEl = document.getElementById('adminNotificationContent');
                
                contentEl.innerHTML = `
                    <div>
                        <strong>🛎️ New Order Received!</strong>
                        <div>Order #: ${order.orderNumber}</div>
                        <div>Customer: ${order.customerName}</div>
                        <div>Total: $${order.total.toFixed(2)}</div>
                        <div>Payment: ${order.payment.method.toUpperCase()}</div>
                        <div>Items: ${order.items.length} products</div>
                        <small>Click to view full details</small>
                    </div>
                `;
                
                adminOrderNotification.style.display = 'block';
                
                // Auto-hide after 10 seconds
                setTimeout(() => {
                    adminOrderNotification.style.display = 'none';
                }, 10000);
            }
        }

        // NEW: Show order details in admin panel
        function showOrderDetails(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (!order) return;
            
            const customer = users.find(u => u.id === order.userId);
            const contentEl = document.getElementById('orderDetailsContent');
            
            let itemsHtml = '';
            order.items.forEach(item => {
                itemsHtml += `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid var(--gray);">
                        <div>
                            <strong>${item.name}</strong>
                            <div>Qty: ${item.quantity} × $${item.price.toFixed(2)}</div>
                            <div>Seller: ${item.seller}</div>
                        </div>
                        <div>$${item.itemTotal.toFixed(2)}</div>
                    </div>
                `;
            });
            
            contentEl.innerHTML = `
                <div class="order-detail-section">
                    <h4>Order Information</h4>
                    <p><strong>Order Number:</strong> ${order.orderNumber}</p>
                    <p><strong>Order Date:</strong> ${new Date(order.date).toLocaleString()}</p>
                    <p><strong>Status:</strong> ${order.status}</p>
                </div>
                
                <div class="order-detail-section">
                    <h4>Customer Information</h4>
                    <p><strong>Name:</strong> ${order.customerName}</p>
                    <p><strong>Email:</strong> ${order.customerEmail}</p>
                    <p><strong>Phone:</strong> ${order.shipping.phone}</p>
                </div>
                
                <div class="order-detail-section">
                    <h4>Shipping Address</h4>
                    <p>${order.shipping.firstName} ${order.shipping.lastName}</p>
                    <p>${order.shipping.address}</p>
                    <p>${order.shipping.city}, ${order.shipping.state} ${order.shipping.zip}</p>
                    <p>${order.shipping.country}</p>
                </div>
                
                <div class="order-detail-section">
                    <h4>Payment Information</h4>
                    <p><strong>Method:</strong> ${order.payment.method.toUpperCase()}</p>
                    ${order.payment.method === 'card' ? `
                        <p><strong>Card:</strong> ${order.payment.card.displayNumber}</p>
                        <p><strong>Name on Card:</strong> ${order.payment.card.name}</p>
                        <p><strong>Expires:</strong> ${order.payment.card.expiry}</p>
                    ` : ''}
                    ${order.payment.method === 'cash' ? '<p><em>Cash on Delivery - Additional $2.00 fee applied</em></p>' : ''}
                </div>
                
                <div class="order-detail-section">
                    <h4>Order Items</h4>
                    ${itemsHtml}
                </div>
                
                <div class="order-detail-section">
                    <h4>Order Summary</h4>
                    <p><strong>Subtotal:</strong> $${order.subtotal.toFixed(2)}</p>
                    <p><strong>Shipping:</strong> $${order.shippingCost.toFixed(2)}</p>
                    <p><strong>Tax:</strong> $${order.tax.toFixed(2)}</p>
                    <p><strong style="font-size: 18px;">Total:</strong> $${order.total.toFixed(2)}</p>
                </div>
            `;
            
            orderDetailsModal.style.display = 'flex';
        }

        // NEW: Hide order details modal
        function hideOrderDetails() {
            orderDetailsModal.style.display = 'none';
        }

        // Check authentication status
        function checkAuthentication() {
            console.log('Checking authentication...', currentUser);
            if (currentUser) {
                console.log('User is authenticated:', currentUser.name);
                showMainApp();
            } else {
                console.log('No user authenticated, showing auth screen');
                showAuthScreen();
            }
        }

        // Show authentication screen
        function showAuthScreen() {
            console.log('Showing auth screen');
            authScreen.style.display = 'flex';
            mainApp.style.display = 'none';
        }

        // Show main application
        function showMainApp() {
            console.log('Showing main app for user:', currentUser.name);
            authScreen.style.display = 'none';
            mainApp.style.display = 'block';
            updateUIForUser();
            renderProducts();
            renderCart();
        }

        // Update UI based on user privileges
        function updateUIForUser() {
            const userGreeting = document.getElementById('userGreeting');
            const userAccountText = document.getElementById('userAccountText');
            
            if (currentUser) {
                userGreeting.textContent = `Hello, ${currentUser.name.split(' ')[0]}`;
                userAccountText.textContent = 'Your Account';

                // Show/hide admin features
                if (hasSellingPrivileges()) {
                    console.log('User has admin privileges, showing admin features');
                    sellNav.style.display = 'block';
                    adminNav.style.display = 'block';
                    sellLink.style.display = 'block';
                    adminLink.style.display = 'block';
                } else {
                    console.log('User does not have admin privileges');
                    sellNav.style.display = 'none';
                    adminNav.style.display = 'none';
                    sellLink.style.display = 'none';
                    adminLink.style.display = 'none';
                }
            }
        }

        // Check if user has admin privileges
        function hasSellingPrivileges() {
            return currentUser && currentUser.email === SECURITY_CONFIG.adminEmail;
        }

        // Switch authentication tabs
        function switchAuthTab(formType) {
            console.log('Switching to auth tab:', formType);
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.auth-tab[data-form="${formType}"]`).classList.add('active');
            
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.remove('active');
            });
            document.getElementById(`${formType}Form`).classList.add('active');
        }

        // Handle user login
        function handleLogin() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            console.log('Login attempt for:', email);
            
            if (!email || !password) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            const loginBtn = document.getElementById('loginBtn');
            const loginText = document.getElementById('loginText');
            const loginLoading = document.getElementById('loginLoading');
            
            loginText.style.display = 'none';
            loginLoading.style.display = 'inline-block';
            loginBtn.disabled = true;

            setTimeout(() => {
                const user = users.find(u => u.email === email && u.password === password);
                
                if (user) {
                    console.log('Login successful for user:', user.name);
                    currentUser = user;
                    saveData();
                    showMainApp();
                    showNotification(`Welcome back, ${user.name}!`);
                    document.getElementById('loginForm').reset();
                } else {
                    console.log('Login failed for email:', email);
                    showNotification('Invalid email or password', 'error');
                }

                loginText.style.display = 'inline-block';
                loginLoading.style.display = 'none';
                loginBtn.disabled = false;
            }, 1000);
        }

        // Handle user registration
        function handleRegister() {
            const name = document.getElementById('registerName').value.trim();
            const email = document.getElementById('registerEmail').value.trim().toLowerCase();
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;

            console.log('Registration attempt for:', email);

            if (!name || !email || !password || !confirmPassword) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            if (password.length < 6) {
                showNotification('Password must be at least 6 characters long', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }

            if (!isValidEmail(email)) {
                showNotification('Please enter a valid email address', 'error');
                return;
            }

            if (users.find(u => u.email === email)) {
                showNotification('User with this email already exists', 'error');
                return;
            }

            const registerBtn = document.getElementById('registerBtn');
            const registerText = document.getElementById('registerText');
            const registerLoading = document.getElementById('registerLoading');
            
            registerText.style.display = 'none';
            registerLoading.style.display = 'inline-block';
            registerBtn.disabled = true;

            setTimeout(() => {
                const newUser = {
                    id: generateId(),
                    name,
                    email,
                    password,
                    role: 'user',
                    createdAt: new Date().toISOString()
                };

                users.push(newUser);
                currentUser = newUser;
                saveData();
                showMainApp();
                showNotification('Account created successfully! Welcome to Murshid!');
                document.getElementById('registerForm').reset();

                registerText.style.display = 'inline-block';
                registerLoading.style.display = 'none';
                registerBtn.disabled = false;
            }, 1000);
        }

        // Show logout confirmation
        function showLogoutConfirmation() {
            console.log('Showing logout confirmation');
            logoutModal.style.display = 'flex';
            document.getElementById('userDropdown').classList.remove('active');
        }

        // Hide logout confirmation
        function hideLogoutConfirmation() {
            console.log('Hiding logout confirmation');
            logoutModal.style.display = 'none';
        }

        // Handle logout
        function handleLogout() {
            console.log('Logging out user:', currentUser.name);
            currentUser = null;
            saveData();
            hideLogoutConfirmation();
            showAuthScreen();
            showNotification('You have been signed out successfully');
        }

        // Switch between main tabs
        function switchTab(tabName) {
            console.log('Switching to tab:', tabName);
            // Update navigation
            document.querySelectorAll('.secondary-nav li').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-tab') === tabName) {
                    item.classList.add('active');
                }
            });

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');

            // Hide product detail view
            productDetail.classList.remove('active');

            // Refresh data if needed
            if (tabName === 'browse') {
                renderProducts();
            } else if (tabName === 'cart') {
                renderCart();
            } else if (tabName === 'admin') {
                renderAdminPanel();
            } else if (tabName === 'account') {
                renderAccountDetails();
            }
        }

        // Render products grid
        function renderProducts(filteredProducts = null) {
            const productsToRender = filteredProducts || products;
            console.log('Rendering products:', productsToRender.length);
            
            if (productsToRender.length === 0) {
                noProductsMessage.style.display = 'block';
                productsGrid.innerHTML = '';
                return;
            }
            
            noProductsMessage.style.display = 'none';
            productsGrid.innerHTML = '';
            
            productsToRender.forEach(product => {
                const productCard = createProductCard(product);
                productsGrid.appendChild(productCard);
            });
        }

        // Create product card element
        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            
            const imageContent = product.images && product.images.length > 0 
                ? `<img src="${product.images[0]}" alt="${product.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">`
                : '';
            
            const adminControls = hasSellingPrivileges() ? `
                <div class="admin-controls">
                    <button class="admin-btn edit" data-id="${product.id}" title="Edit Product">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="admin-btn delete" data-id="${product.id}" title="Delete Product">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            ` : '';
            
            card.innerHTML = `
                ${adminControls}
                <div class="product-image">
                    ${imageContent}
                    <div class="no-image" style="${product.images && product.images.length > 0 ? 'display: none;' : ''}">
                        <i class="fas fa-box"></i>
                    </div>
                </div>
                <div class="product-title">${escapeHtml(product.name)}</div>
                <div class="product-seller">Sold by: ${escapeHtml(product.seller)}</div>
                <div class="product-rating">
                    ${generateStarRating(product.rating)}
                </div>
                <div class="product-price">$${product.price.toFixed(2)}</div>
                <div class="product-stock">${product.stock} in stock</div>
                <div class="product-actions">
                    <button class="add-to-cart" data-id="${product.id}">Add to Cart</button>
                    <button class="buy-now" data-id="${product.id}">Buy Now</button>
                </div>
            `;
            
            // Add event listeners
            card.querySelector('.add-to-cart').addEventListener('click', function(e) {
                e.stopPropagation();
                addToCart(product.id);
            });
            
            card.querySelector('.buy-now').addEventListener('click', function(e) {
                e.stopPropagation();
                addToCart(product.id);
                switchTab('cart');
            });

            // Add click event to show product detail
            card.addEventListener('click', function(e) {
                if (!e.target.classList.contains('add-to-cart') && 
                    !e.target.classList.contains('buy-now') &&
                    !e.target.classList.contains('admin-btn')) {
                    showProductDetail(product.id);
                }
            });

            // Add admin control listeners
            if (hasSellingPrivileges()) {
                const editBtn = card.querySelector('.admin-btn.edit');
                const deleteBtn = card.querySelector('.admin-btn.delete');
                
                if (editBtn) {
                    editBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        console.log('Edit product clicked:', product.id);
                        editProduct(product.id);
                    });
                }
                
                if (deleteBtn) {
                    deleteBtn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        console.log('Delete product clicked:', product.id);
                        deleteProduct(product.id);
                    });
                }
            }
            
            return card;
        }

        // Show product detail view
        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            currentProductDetail = product;
            
            // Update product detail elements
            document.getElementById('productDetailTitle').textContent = product.name;
            document.getElementById('productDetailSeller').textContent = `Sold by: ${product.seller}`;
            document.getElementById('productDetailRating').innerHTML = `${generateStarRating(product.rating)}`;
            document.getElementById('productDetailPrice').textContent = `$${product.price.toFixed(2)}`;
            document.getElementById('productDetailStock').textContent = `${product.stock} in stock`;
            document.getElementById('productDetailDescription').textContent = product.description;
            
            // Update images
            const mainImage = document.getElementById('productDetailMainImage');
            const thumbnails = document.getElementById('productDetailThumbnails');
            
            mainImage.innerHTML = '';
            thumbnails.innerHTML = '';
            
            if (product.images && product.images.length > 0) {
                const mainImg = document.createElement('img');
                mainImg.src = product.images[0];
                mainImg.alt = product.name;
                mainImage.appendChild(mainImg);
                
                product.images.forEach((image, index) => {
                    const thumbnail = document.createElement('div');
                    thumbnail.className = `product-detail-thumbnail ${index === 0 ? 'active' : ''}`;
                    
                    const thumbnailImg = document.createElement('img');
                    thumbnailImg.src = image;
                    thumbnailImg.alt = `${product.name} - Image ${index + 1}`;
                    
                    thumbnail.appendChild(thumbnailImg);
                    thumbnail.addEventListener('click', function() {
                        // Update main image
                        mainImg.src = image;
                        
                        // Update active thumbnail
                        document.querySelectorAll('.product-detail-thumbnail').forEach(thumb => {
                            thumb.classList.remove('active');
                        });
                        this.classList.add('active');
                    });
                    
                    thumbnails.appendChild(thumbnail);
                });
            } else {
                mainImage.innerHTML = '<i class="fas fa-box no-image" style="font-size: 80px;"></i>';
            }
            
            // Show product detail and hide browse tab
            document.getElementById('browse-tab').classList.remove('active');
            productDetail.classList.add('active');
        }

        // Edit product (admin only)
        function editProduct(productId) {
            console.log('Editing product:', productId);
            const product = products.find(p => p.id === productId);
            if (product) {
                // Populate the form with product data
                document.getElementById('productName').value = product.name;
                document.getElementById('category').value = product.category;
                document.getElementById('price').value = product.price;
                document.getElementById('description').value = product.description;
                document.getElementById('stock').value = product.stock;
                document.getElementById('brand').value = product.brand;
                
                // Switch to sell tab
                switchTab('sell');
                
                // Update the add product button to edit mode
                const addBtn = document.getElementById('addProductBtn');
                addBtn.textContent = 'Update Product';
                addBtn.onclick = function() { updateProduct(productId); };
                
                showNotification('Edit mode: Product data loaded. Update and click "Update Product"', 'info');
            }
        }

        // Update product function
        function updateProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const name = document.getElementById('productName').value.trim();
            const category = document.getElementById('category').value;
            const price = parseFloat(document.getElementById('price').value);
            const description = document.getElementById('description').value.trim();
            const stock = parseInt(document.getElementById('stock').value);
            const brand = document.getElementById('brand').value.trim();
            const preview = document.getElementById('imagePreview');
            const images = Array.from(preview.querySelectorAll('img')).map(img => img.src);

            if (!name || !category || !price || !description || !stock || !brand) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            // Update product
            product.name = escapeHtml(name);
            product.category = category;
            product.price = price;
            product.description = escapeHtml(description);
            product.stock = stock;
            product.brand = escapeHtml(brand);
            product.images = images;

            saveData();
            resetProductForm();
            
            // Reset button to normal mode
            const addBtn = document.getElementById('addProductBtn');
            addBtn.textContent = 'List Product';
            addBtn.onclick = handleAddProduct;
            
            showNotification('Product updated successfully!');
            switchTab('browse');
        }

        // Delete product (admin only)
        function deleteProduct(productId) {
            if (!hasSellingPrivileges()) {
                showNotification('Access denied', 'error');
                return;
            }

            console.log('Deleting product:', productId);
            if (confirm('Are you sure you want to delete this product? This action cannot be undone.')) {
                products = products.filter(p => p.id !== productId);
                saveData();
                renderProducts();
                if (document.getElementById('admin-tab').classList.contains('active')) {
                    renderAdminPanel();
                }
                showNotification('Product deleted successfully');
            }
        }

        // Generate star rating HTML - NO FAKE REVIEWS
        function generateStarRating(rating) {
            // No reviews yet for all products
            return '<i class="far fa-star"></i> No reviews yet';
        }

        // Add product to cart
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            
            if (!product) {
                showNotification('Product not found', 'error');
                return;
            }
            
            if (product.stock < 1) {
                showNotification('This product is out of stock', 'error');
                return;
            }
            
            const existingItem = cart.find(item => item.productId === productId && item.userId === currentUser.id);
            
            if (existingItem) {
                if (existingItem.quantity < product.stock) {
                    existingItem.quantity++;
                } else {
                    showNotification('Not enough stock available', 'error');
                    return;
                }
            } else {
                cart.push({
                    id: generateId(),
                    productId: product.id,
                    name: product.name,
                    price: product.price,
                    quantity: 1,
                    seller: product.seller,
                    userId: currentUser.id,
                    image: product.images && product.images.length > 0 ? product.images[0] : null
                });
            }
            
            saveData();
            updateCartCount();
            showNotification('Product added to cart!');
            
            if (document.getElementById('cart-tab').classList.contains('active')) {
                renderCart();
            }
        }

        // Render cart items
        function renderCart() {
            const userCart = cart.filter(item => item.userId === currentUser.id);
            console.log('Rendering cart with', userCart.length, 'items');
            
            cartItems.innerHTML = '';
            
            if (userCart.length === 0) {
                emptyCart.style.display = 'block';
                cartTotal.style.display = 'none';
                checkoutBtn.style.display = 'none';
                return;
            }
            
            emptyCart.style.display = 'none';
            cartTotal.style.display = 'block';
            checkoutBtn.style.display = 'block';
            
            let total = 0;
            
            userCart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                
                const imageContent = item.image 
                    ? `<img src="${item.image}" alt="${item.name}">`
                    : '<i class="fas fa-box"></i>';
                
                cartItem.innerHTML = `
                    <div class="cart-item-image">
                        ${imageContent}
                    </div>
                    <div class="cart-item-details">
                        <div class="cart-item-title">${escapeHtml(item.name)}</div>
                        <div class="cart-item-seller">Sold by: ${escapeHtml(item.seller)}</div>
                        <div class="cart-item-price">$${item.price.toFixed(2)}</div>
                        <div class="cart-item-quantity">
                            <button class="quantity-btn decrease" data-id="${item.id}">-</button>
                            <input type="number" class="quantity-input" value="${item.quantity}" min="1" data-id="${item.id}">
                            <button class="quantity-btn increase" data-id="${item.id}">+</button>
                        </div>
                    </div>
                    <div class="cart-item-remove" data-id="${item.id}">
                        <i class="fas fa-trash"></i> Remove
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });
            
            totalAmount.textContent = total.toFixed(2);
            
            // Add event listeners to cart controls
            document.querySelectorAll('.decrease').forEach(btn => {
                btn.addEventListener('click', function() {
                    updateCartQuantity(this.getAttribute('data-id'), -1);
                });
            });
            
            document.querySelectorAll('.increase').forEach(btn => {
                btn.addEventListener('click', function() {
                    updateCartQuantity(this.getAttribute('data-id'), 1);
                });
            });
            
            document.querySelectorAll('.quantity-input').forEach(input => {
                input.addEventListener('change', function() {
                    const newQuantity = parseInt(this.value);
                    if (newQuantity < 1) {
                        this.value = 1;
                        updateCartQuantity(this.getAttribute('data-id'), 0, 1);
                    } else {
                        updateCartQuantity(this.getAttribute('data-id'), 0, newQuantity);
                    }
                });
            });
            
            document.querySelectorAll('.cart-item-remove').forEach(btn => {
                btn.addEventListener('click', function() {
                    removeFromCart(this.getAttribute('data-id'));
                });
            });
        }

        // Update cart quantity
        function updateCartQuantity(itemId, change, setQuantity = null) {
            const item = cart.find(item => item.id === itemId);
            const product = products.find(p => p.id === item.productId);
            
            if (!item || !product) return;
            
            let newQuantity;
            
            if (setQuantity !== null) {
                newQuantity = setQuantity;
            } else {
                newQuantity = item.quantity + change;
            }
            
            if (newQuantity > product.stock) {
                showNotification('Not enough stock available', 'error');
                return;
            }
            
            if (newQuantity < 1) {
                removeFromCart(itemId);
                return;
            }
            
            item.quantity = newQuantity;
            saveData();
            updateCartCount();
            renderCart();
        }

        // Remove item from cart
        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            saveData();
            updateCartCount();
            renderCart();
            showNotification('Product removed from cart');
        }

        // Update cart count
        function updateCartCount() {
            const userCart = cart.filter(item => item.userId === currentUser.id);
            const totalItems = userCart.reduce((total, item) => total + item.quantity, 0);
            cartCount.textContent = totalItems;
        }

        // Handle image upload
        function handleImageUpload(e) {
            const files = e.target.files;
            const preview = document.getElementById('imagePreview');
            const currentImages = preview.querySelectorAll('.preview-item').length;
            
            if (currentImages + files.length > SECURITY_CONFIG.maxImages) {
                showNotification(`Maximum ${SECURITY_CONFIG.maxImages} images allowed`, 'error');
                return;
            }
            
            Array.from(files).forEach(file => {
                if (!SECURITY_CONFIG.allowedImageTypes.includes(file.type)) {
                    showNotification('Invalid file type. Please upload JPG, PNG, or GIF images.', 'error');
                    return;
                }
                
                if (file.size > SECURITY_CONFIG.maxImageSize) {
                    showNotification('File size too large. Maximum 2MB per image.', 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    previewItem.innerHTML = `
                        <img src="${e.target.result}" alt="Preview">
                        <button type="button" class="remove-image">&times;</button>
                    `;
                    
                    previewItem.querySelector('.remove-image').addEventListener('click', function() {
                        previewItem.remove();
                    });
                    
                    preview.appendChild(previewItem);
                };
                reader.readAsDataURL(file);
            });
            
            e.target.value = '';
        }

        // Handle add product
        function handleAddProduct() {
            if (!hasSellingPrivileges()) {
                showNotification('Product listing privileges are restricted', 'error');
                return;
            }
            
            const name = document.getElementById('productName').value.trim();
            const category = document.getElementById('category').value;
            const price = parseFloat(document.getElementById('price').value);
            const description = document.getElementById('description').value.trim();
            const stock = parseInt(document.getElementById('stock').value);
            const brand = document.getElementById('brand').value.trim();
            const preview = document.getElementById('imagePreview');
            const images = Array.from(preview.querySelectorAll('img')).map(img => img.src);

            if (!name || !category || !price || !description || !stock || !brand) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            if (price <= 0 || price > 100000) {
                showNotification('Please enter a valid price between $0.01 and $100,000', 'error');
                return;
            }

            if (stock < 1 || stock > 10000) {
                showNotification('Please enter a valid stock quantity between 1 and 10,000', 'error');
                return;
            }

            const product = {
                id: generateId(),
                name: escapeHtml(name),
                category,
                price,
                description: escapeHtml(description),
                stock,
                brand: escapeHtml(brand),
                seller: currentUser.email,
                rating: 0, // No fake reviews
                dateAdded: new Date().toISOString(),
                images: images
            };

            products.push(product);
            saveData();
            resetProductForm();
            showNotification('Product listed successfully!');
            switchTab('browse');
        }

        // Reset product form
        function resetProductForm() {
            document.getElementById('productName').value = '';
            document.getElementById('category').value = '';
            document.getElementById('price').value = '';
            document.getElementById('description').value = '';
            document.getElementById('stock').value = '';
            document.getElementById('brand').value = '';
            document.getElementById('imagePreview').innerHTML = '';
        }

        // NEW: Enhanced admin panel with order details
        function renderAdminPanel() {
            if (!hasSellingPrivileges()) {
                showNotification('Access denied. Admin privileges required.', 'error');
                switchTab('browse');
                return;
            }
            
            console.log('Rendering admin panel');
            
            // Update stats
            document.getElementById('totalUsers').textContent = users.length;
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('totalOrders').textContent = orders.length;
            document.getElementById('totalRevenue').textContent = '$' + 
                orders.reduce((total, order) => total + order.total, 0).toFixed(2);

            // Render products table
            const productsTable = document.getElementById('adminProductsTable');
            productsTable.innerHTML = '';
            
            products.forEach(product => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${product.id.slice(-6)}</td>
                    <td>${escapeHtml(product.name)}</td>
                    <td>${product.category}</td>
                    <td>$${product.price.toFixed(2)}</td>
                    <td>${product.stock}</td>
                    <td>
                        <div class="action-btns">
                            <button class="action-btn edit-btn" data-id="${product.id}">Edit</button>
                            <button class="action-btn delete-btn" data-id="${product.id}">Delete</button>
                        </div>
                    </td>
                `;
                productsTable.appendChild(row);
            });

            // Render users table
            const usersTable = document.getElementById('adminUsersTable');
            usersTable.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.id.slice(-6)}</td>
                    <td>${escapeHtml(user.name)}</td>
                    <td>${user.email}</td>
                    <td>${user.role}</td>
                    <td>${new Date(user.createdAt).toLocaleDateString()}</td>
                `;
                usersTable.appendChild(row);
            });

            // NEW: Enhanced orders table with view details
            const ordersTable = document.getElementById('adminOrdersTable');
            ordersTable.innerHTML = '';
            
            // Show recent orders (last 10)
            const recentOrders = orders.slice(-10).reverse();
            
            recentOrders.forEach(order => {
                const customer = users.find(u => u.id === order.userId);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.orderNumber}</td>
                    <td>${customer ? customer.name : 'Unknown'}</td>
                    <td>${new Date(order.date).toLocaleDateString()}</td>
                    <td>$${order.total.toFixed(2)}</td>
                    <td>${order.status}</td>
                    <td>
                        <div class="action-btns">
                            <button class="action-btn edit-btn" onclick="showOrderDetails('${order.id}')">View</button>
                        </div>
                    </td>
                `;
                ordersTable.appendChild(row);
            });

            // Add event listeners to admin buttons
            document.querySelectorAll('#adminProductsTable .edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    console.log('Admin edit clicked:', this.getAttribute('data-id'));
                    editProduct(this.getAttribute('data-id'));
                });
            });
            
            document.querySelectorAll('#adminProductsTable .delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    console.log('Admin delete clicked:', this.getAttribute('data-id'));
                    deleteProduct(this.getAttribute('data-id'));
                });
            });
        }

        // Render account details
        function renderAccountDetails() {
            if (!currentUser) return;

            // Update account information
            document.getElementById('accountName').textContent = currentUser.name;
            document.getElementById('accountEmail').textContent = currentUser.email;
            document.getElementById('accountRole').textContent = currentUser.role;
            document.getElementById('accountSince').textContent = new Date(currentUser.createdAt).toLocaleDateString();
            
            // Update statistics
            const userProducts = products.filter(p => p.seller === currentUser.email).length;
            const userCart = cart.filter(item => item.userId === currentUser.id);
            const userOrders = orders.filter(o => o.userId === currentUser.id).length;
            
            document.getElementById('accountProducts').textContent = userProducts;
            document.getElementById('accountCartItems').textContent = userCart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('accountOrders').textContent = userOrders;
            
            // Populate form fields
            document.getElementById('updateName').value = currentUser.name;
            document.getElementById('updateEmail').value = currentUser.email;
        }

        // Update profile
        function updateProfile() {
            const name = document.getElementById('updateName').value.trim();
            const email = document.getElementById('updateEmail').value.trim().toLowerCase();

            if (!name || !email) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            if (!isValidEmail(email)) {
                showNotification('Please enter a valid email address', 'error');
                return;
            }

            // Check if email is already taken by another user
            if (email !== currentUser.email && users.find(u => u.email === email)) {
                showNotification('Email address is already taken', 'error');
                return;
            }

            // Update user data
            currentUser.name = name;
            currentUser.email = email;

            // Update products if user is admin
            if (hasSellingPrivileges()) {
                products.forEach(product => {
                    if (product.seller === SECURITY_CONFIG.adminEmail) {
                        product.seller = email;
                    }
                });
            }

            saveData();
            updateUIForUser();
            showNotification('Profile updated successfully!');
        }

        // Change password
        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmNewPassword = document.getElementById('confirmNewPassword').value;

            if (!currentPassword || !newPassword || !confirmNewPassword) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            if (currentPassword !== currentUser.password) {
                showNotification('Current password is incorrect', 'error');
                return;
            }

            if (newPassword.length < 6) {
                showNotification('New password must be at least 6 characters long', 'error');
                return;
            }

            if (newPassword !== confirmNewPassword) {
                showNotification('New passwords do not match', 'error');
                return;
            }

            currentUser.password = newPassword;
            saveData();
            
            // Clear password fields
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmNewPassword').value = '';
            
            showNotification('Password changed successfully!');
        }

        // Perform search
        function performSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase().trim();
            const category = document.getElementById('searchCategory').value;
            
            let filteredProducts = products;
            
            if (query) {
                filteredProducts = filteredProducts.filter(product => 
                    product.name.toLowerCase().includes(query) || 
                    product.description.toLowerCase().includes(query) ||
                    product.brand.toLowerCase().includes(query)
                );
            }
            
            if (category !== 'all') {
                filteredProducts = filteredProducts.filter(product => product.category === category);
            }
            
            renderProducts(filteredProducts);
            
            if (filteredProducts.length === 0) {
                showNotification('No products found matching your search', 'warning');
            }
        }

        // Security utility functions
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('murshid_users', JSON.stringify(users));
            localStorage.setItem('murshid_products', JSON.stringify(products));
            localStorage.setItem('murshid_cart', JSON.stringify(cart));
            localStorage.setItem('murshid_orders', JSON.stringify(orders));
            localStorage.setItem('murshid_currentUser', JSON.stringify(currentUser));
        }

        // Show notification
        function showNotification(message, type = 'success') {
            notification.textContent = message;
            notification.className = 'notification';
            
            if (type === 'error') {
                notification.classList.add('error');
            } else if (type === 'warning') {
                notification.classList.add('warning');
            } else if (type === 'info') {
                notification.classList.add('warning');
            }
            
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }
    </script>
</body>
</html>